<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Car Game</title>
  <style>
    body { margin: 0; overflow: hidden; }
    #header {
      position: absolute;
      top: 0;
      width: 100%;
      background: #333;
      color: white;
      text-align: center;
      padding: 10px;
      z-index: 100;
    }
    #stripe {
      background: yellow;
      color: black;
      padding: 5px;
      font-weight: bold;
      animation: moveStripe 10s linear infinite;
    }
    @keyframes moveStripe {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    #leaderboard {
      position: absolute;
      top: 100px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px;
      border-radius: 5px;
      z-index: 100;
    }
    #game-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <!-- Header with Logo and Moving Stripe -->
  <div id="header">
    <div>My Logo</div>
    <div id="stripe">Domain for Sale $500</div>
  </div>

  <!-- Leaderboard -->
  <div id="leaderboard">
    <h3>Leaderboard</h3>
    <ul id="leaderboard-list"></ul>
  </div>

  <!-- Game Container -->
  <div id="game-container"></div>

  <!-- Three.js Library and GLTF Loader -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/examples/js/loaders/GLTFLoader.js"></script>
  <script>
    // Game Script
    let scene, camera, renderer, car, road, obstacles = [];
    let score = 0, speed = 0.1, gameOver = false;
    let playerName = '';
    let leaderboard = [];

    // Initialize Scene
    function init() {
      // Scene
      scene = new THREE.Scene();

      // Camera
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(0, 5, 15);
      camera.lookAt(0, 0, 0);

      // Renderer
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.getElementById('game-container').appendChild(renderer.domElement);

      // Add Lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
      scene.add(ambientLight);
      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
      directionalLight.position.set(0, 1, 0);
      scene.add(directionalLight);

      // Road with Lane Markings
      const roadGeometry = new THREE.BoxGeometry(10, 0.1, 1000);
      const roadMaterial = new THREE.MeshBasicMaterial({ color: 0x808080 });
      road = new THREE.Mesh(roadGeometry, roadMaterial);
      road.position.y = -1;
      scene.add(road);

      // Lane Markings
      const laneMarkingGeometry = new THREE.BoxGeometry(0.5, 0.1, 10);
      const laneMarkingMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
      for (let i = 0; i < 100; i++) {
        const laneMarking = new THREE.Mesh(laneMarkingGeometry, laneMarkingMaterial);
        laneMarking.position.set(0, -0.9, -i * 20);
        scene.add(laneMarking);
      }

      // Grass
      const grassGeometry = new THREE.BoxGeometry(50, 0.1, 1000);
      const grassMaterial = new THREE.MeshBasicMaterial({ color: 0x00aa00 });
      const grassLeft = new THREE.Mesh(grassGeometry, grassMaterial);
      grassLeft.position.set(-20, -1, 0);
      scene.add(grassLeft);
      const grassRight = new THREE.Mesh(grassGeometry, grassMaterial);
      grassRight.position.set(20, -1, 0);
      scene.add(grassRight);

      // Sky
      scene.background = new THREE.Color(0x87CEEB);

      // Load 3D Car
      const loader = new THREE.GLTFLoader();
      loader.load('./assets/car.glb', (gltf) => {
        car = gltf.scene;
        car.scale.set(1, 1, 1); // Adjust scale if needed
        car.position.set(0, 0.5, 0); // Position the car on the road
        car.rotation.y = Math.PI; // Rotate the car to face the correct direction
        scene.add(car);
      });

      // Load 3D Obstacles
      function createObstacle() {
        loader.load('./assets/obstacle.glb', (gltf) => {
          const obstacle = gltf.scene;
          obstacle.scale.set(1, 1, 1); // Adjust scale if needed
          obstacle.position.set(Math.random() * 6 - 3, 0.5, -50); // Position obstacles on the road
          obstacles.push(obstacle);
          scene.add(obstacle);
        });
      }

      // Billboards
      const billboardTexture = new THREE.TextureLoader().load('./assets/billboard.jpg'); // Replace with your image
      const billboardMaterial = new THREE.MeshBasicMaterial({ map: billboardTexture });
      const billboardGeometry = new THREE.BoxGeometry(4, 6, 0.1); // Adjust size if needed
      const billboard1 = new THREE.Mesh(billboardGeometry, billboardMaterial);
      billboard1.position.set(-8, 3, -20); // Position billboard on the left side of the road
      scene.add(billboard1);
      const billboard2 = new THREE.Mesh(billboardGeometry, billboardMaterial);
      billboard2.position.set(8, 3, -20); // Position billboard on the right side of the road
      scene.add(billboard2);

      // Obstacles
      createObstacle();

      // Event Listeners
      window.addEventListener('resize', onWindowResize);
      document.addEventListener('keydown', onKeyDown);

      // Ask for player name at the start
      playerName = prompt("Enter your name:");
      if (!playerName) playerName = "Anonymous";
    }

    // Handle Window Resize
    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    // Handle Key Press
    function onKeyDown(event) {
      if (event.key === 'ArrowLeft' && car.position.x > -4) car.position.x -= 1;
      if (event.key === 'ArrowRight' && car.position.x < 4) car.position.x += 1;
    }

    // Update Leaderboard
    function updateLeaderboard(name, score) {
      leaderboard.push({ name, score });
      leaderboard.sort((a, b) => b.score - a.score); // Sort by score (descending)
      const leaderboardList = document.getElementById('leaderboard-list');
      leaderboardList.innerHTML = leaderboard
        .slice(0, 5) // Show top 5
        .map((entry, index) => `<li>${index + 1}. ${entry.name} - ${entry.score}</li>`)
        .join('');
    }

    // Game Loop
    function animate() {
      if (gameOver) return;

      requestAnimationFrame(animate);

      // Move Road and Obstacles
      road.position.z += speed;
      obstacles.forEach(obstacle => {
        obstacle.position.z += speed;
        if (obstacle.position.z > 10) {
          scene.remove(obstacle);
          obstacles.splice(obstacles.indexOf(obstacle), 1);
          createObstacle();
          score += 1;
          speed += 0.01;
        }

        // Check Collision
        if (Math.abs(car.position.x - obstacle.position.x) < 1 && Math.abs(car.position.z - obstacle.position.z) < 1) {
          gameOver = true;
          updateLeaderboard(playerName, score);
          alert(`Game Over! Score: ${score}`);
          playerName = prompt("Enter your name for the next game:");
          if (!playerName) playerName = "Anonymous";
          score = 0;
          speed = 0.1;
          gameOver = false;
        }
      });

      renderer.render(scene, camera);
    }

    // Start Game
    init();
    animate();
  </script>
</body>
</html>